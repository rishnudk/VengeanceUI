import { CodeBlock, Dependencies } from '@/components/docs/component-installation'
import { CLICommand } from '@/components/docs/cli-command'
import { PropsTable } from '@/components/docs/props-table'
import { ComponentPreview } from '@/components/docs/component-preview'
import {ScrollEffectDemo} from '@/components/docs/scroll-effect'

# Scroll Effect

A smooth, element clip animation on scroll

<ComponentPreview 

component={<ScrollEffectDemo/>}
code={`import { ScrollEffect } from "@/components/ui/scroll-effect"

const images = {
    start: ['https://images.unsplash.com/photo-1759776054700-e6912d243d49?w=600', 'https://images.unsplash.com/photo-1761991062157-df67faab3a23?w=600'],
    middle: ['https://images.unsplash.com/photo-1762029261747-e9dea65803fb?w=600', 'https://images.unsplash.com/photo-1760159201322-8a0574c1296c?w=600'],
    featured: 'https://images.unsplash.com/photo-1760867191563-791f803e1bcd?w=1600'
}

export function ScrollEffect(){
    return(
        <ScrollEffect 
        images={images}
        />
    )
}`}
/>

## Install using CLI

<CLICommand componentName="scroll-effect" />

## Install Manually

<Dependencies step={1} title="Add util file">
    <p className="text-[13px] text-muted-foreground mt-2 mb-8">
        <code className="text-foreground font-mono text-xs bg-neutral-100 dark:bg-[#161616] border border-neutral-200 dark:border-neutral-800 px-2 py-1 rounded-md">lib/utils.ts</code>
    </p>
    <CodeBlock 
        language="tsx"
        code={`import { ClassValue, clsx } from "clsx";
import { twMerge } from "tailwind-merge";

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}`}
    />
</Dependencies>

<Dependencies step={2} title="Add styles to global CSS">
    <p className="text-[13px] text-muted-foreground mt-2 mb-8">Add the following styles to your <code className="text-foreground font-mono text-xs bg-neutral-100 dark:bg-[#161616] border border-neutral-200 dark:border-neutral-800 px-2 py-1 rounded-md mx-1">app/globals.css</code> file</p>
    <CodeBlock 
        language="css"
        code={`/* ScrollEffect - CSS Variables & Animations */
@property --k{
    syntax: '<number>';
    initial-value: 0 ;
    inherits: true;
}

.clip-root{
    --g : 1rem;
    --n : 2;
    position: sticky;
    top:0;
    height: 110dvh;
    padding: var(--g);
    display: grid;
    grid-template:  repeat(3 , 1fr) / repeat(3 , 1fr);
    grid-auto-rows: 1fr;
    gap: var(--g);
    overflow: hidden;
}

.clip-img{
    --_j: var(--j , 0);
    --p: calc(2 * var(--_j) + 1);
    --s: sign(var(--_j) - 0.5);
    grid-area: 2 / var(--p);
    justify-self: var(--j , end); 
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: var(--g);
    contain: size;
    &:nth-child(n+3){
        --j: 1
    }
}

.feat{
    grid-area: 1 / 1 / -1 / -1 ; 
    height: 200%; 
    clip-path: inset(
        0 calc(min(1 ,2 * var(--k))  * (100% + var(--g)) / 3)
        round var(--g)
    );
    z-index: 1;
}

.clip-img:not(.feat){
    --d: calc(
        clamp(
            0 , var(--i) + (1-2 * var(--k)) * (var(--n) - 1) ,
            1
        ) * 33cqw
    );
    transform: translate(
        calc(var(--s) * var(--d)),
        calc(0.5 * var(--d))
    );
    z-index: 0;
}

.mid{
    --j: 1;
    grid-column: var(--p);
    grid-row: calc(var(--i) + 1); 
     &:nth-child(5){
        width: 80%;
        height: 150px;
    }
    &:nth-child(4){
        margin-top: -200px;
        width: 40%;
        height: 200px;
    }
}

.end{
    grid-column: var(--p);
    grid-row: calc(var(--i) + 1);
    --j:1; 
    &:nth-child(1){
        width: 80%;
        height: 200px;
           justify-self: end;
    }
    &:nth-child(2){
        width: 40%;
        height: 200px;
       justify-self: end;
    }
}
`}
    />
</Dependencies>

<Dependencies step={3} title="Copy the source code">
    <p className="text-[13px] text-muted-foreground mt-2 mb-8">Copy the code below and paste it into <code className="text-foreground font-mono text-xs bg-neutral-100 dark:bg-[#161616] border border-neutral-200 dark:border-neutral-800 px-2 py-1 rounded-md mx-1">components/ui/scroll-effect.tsx</code></p>
    <CodeBlock
        language="tsx"
        title="components/ui/scroll-effect.tsx"
        expandable={true}
        code={`
"use client";
import React, { useRef } from 'react';
import { motion, useScroll, useTransform } from 'framer-motion';
import { cn } from '@/lib/utils';

type ImageProps = {
        start: string[];
        middle: string[];
        featured: string;
}

interface ScrollEffectProps{
    images: ImageProps;
    className?: string;
}

export function ScrollEffect  ({ images , className }: ScrollEffectProps)  {



    const sectionRef = useRef<HTMLDivElement>(null);
    const { scrollYProgress } = useScroll({
        target: sectionRef,
        offset: ['start start', 'end start']
    })
    const k = useTransform(scrollYProgress, [0, 1], [0, 1])
    const {start , middle , featured}= images

    return (
         <section ref={sectionRef} className={cn('relative h-[400dvh]' , className)}>
            <motion.main className='clip-root' style={{
                ['--k' as any]: k
            }}>
                {start.map((src, i) => (
                    <img key={\`start-\${i}\`}
                        src={src}
                        className={cn('clip-img end')}
                         style={{
                            ['--i' as any]: i,
                            ['--j' as any]: 0
                        }}
                        alt=''
                    />
                ));
                }

                {/* featured image */}
                <img src={featured}
                    className='clip-img feat'
                    alt=''
                />

                {/* middle images */}
                {
                    middle.map((src, i) =>
                    (
                        <img key={\`mid-\${i}\`}
                            src={src}
                            className={cn('clip-img mid')}
                            style={{
                                ['--i' as any]: i + start.length,
                                ['--j' as any]: 1
                            }}
                            alt=''
                        />
                    ))
                }
              </motion.main>
         </section>
    );
};
`}
    />
</Dependencies>